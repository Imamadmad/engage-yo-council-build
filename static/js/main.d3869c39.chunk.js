(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{24:function(e,t,n){e.exports=n(36)},29:function(e,t,n){},34:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(2),o=n.n(a),r=n(16),i=n.n(r),c=(n(29),n(8)),s=n.n(c),l=n(14),u=n(10),m=n(17),p=n(18),d=n(23),h=n(21),g=n(15),f=(n(34),n(6)),v=n.n(f),b=n(20);function w(e){return"mailto:".concat(encodeURI(e.mailAddress),"?subject=").concat(encodeURIComponent(e.subject),"&body=").concat(encodeURIComponent(e.body))}function k(e){var t=e.item,n="https://s2.googleusercontent.com/s2/favicons?domain_url=".concat(t.Link);switch(t.Category){case"park":n="https://i.pinimg.com/originals/20/54/42/205442f452d956de1fae3d8fb7c90d10.png";break;case"traffic":n="https://img.icons8.com/android/24/000000/traffic-light.png";break;case"cycle":n="https://img.icons8.com/cotton/64/000000/bicycle--v1.png";break;case"retail":n="https://img.icons8.com/pastel-glyph/64/000000/shop.png";break;case"housing":n="https://img.icons8.com/material-rounded/24/000000/cottage--v2.png"}return o.a.createElement("div",null,o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("img",{src:n,height:20,width:20,style:{margin:"0px 4px",marginTop:4},alt:"icon"}),o.a.createElement("h2",{style:{margin:0,marginTop:4}},o.a.createElement("a",{href:t.Link,target:"_blank"},t.Title))),o.a.createElement(y,{item:t}),o.a.createElement("p",null,t.Councilname),o.a.createElement("p",null,t.Fulldescription))}function y(e){var t=e.item,n=t.Email?{mailAddress:t.Email,subject:"Submission regarding ".concat(t.Title||"<find the title on the council's website>"),body:"I'm emailing you to express my support for the proposal detailed at ".concat(t.Link,".\nReplace this line with your comments to personalise the message!")}:null,a=t.Email?{mailAddress:t.Email,subject:"Submission regarding ".concat(t.Title||"<find the title on the council's website>"),body:"I'm emailing you to express my disagreement with the proposal detailed at ".concat(t.Link,".\nReplace this line with your comments to personalise the message!")}:null;return n&&a?o.a.createElement("p",null,o.a.createElement("a",{href:w(n)},"I agree",o.a.createElement("img",{src:"https://img.icons8.com/cotton/64/000000/thumb-up--v1.png",height:12}))," /",o.a.createElement("a",{href:w(a)},"I disagree",o.a.createElement("img",{src:"https://img.icons8.com/cotton/64/000000/thumbs-down--v4.png",height:12}))):null}function E(e){return{id:parseInt(e[0]),Councilname:e[1],Longitude:parseFloat(e[2]),Latitude:parseFloat(e[3]),Title:e[4],Link:e[5],Emailcontactname:e[6],Email:e[7],Phonenumber:e[8],Surveylink:"null"===e[9]?"":e[9],Fulldescription:e[10],OpenUnderreviewclosed:e[11],Category:e[12]||""}}function C(e){for(var t=[],n=[],a=0;a<e.length;a++){var o=e[a].gs$cell,r=o.$t;1==o.col&&(n[0]&&"id"!=n[0]&&t.push(n),n=[]),n.push(r)}return n[0]&&"id"!=n[0]&&t.push(n),t}function L(e){e.addControl(new v.a.NavigationControl),e.addControl(new v.a.FullscreenControl),e.addControl(new v.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}))}function j(e){e.map((function(e){return e.remove()}))}function S(e,t){return t.filter((function(e){return e.Latitude&&e.Longitude})).map((function(t){return function(e,t){e.Title,e.Link;var n=e.Latitude,a=e.Longitude,r=e.Category,i=new v.a.Popup({offset:25}).setHTML(Object(b.renderToString)(o.a.createElement(k,{item:e}))),c={};switch(r){case"park":c.color="green";break;case"traffic":c.color="grey";break;case"cycle":c.color="red";break;case"retail":c.color="orange";break;case"housing":c.color="blue"}return new v.a.Marker(c).setLngLat([n,a]).setPopup(i).addTo(t)}(t,e)}))}var x=n(22),O=["Cycle","Park","Zoning","Traffic"],T=function(e){var t=e.onSearchTermUpdated,n=Object(a.useState)(""),r=Object(x.a)(n,2),i=r[0],c=r[1];Object(a.useEffect)((function(){t(i)}),[i]);return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{id:"search_container"},o.a.createElement("h3",null,"Search:"),o.a.createElement("input",{type:"text",onChange:function(e){return c(e.target.value)},value:i})),o.a.createElement("div",{id:"search_suggestions"},O.map((function(e){return o.a.createElement("button",{onClick:function(){return c(e)}},e)}))))},I={viewport:{longitude:151.2093,latitude:-33.8688,zoom:13}},A=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(m.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state=I,e.updateViewport=function(t){e.setState((function(e){return{viewport:Object(u.a)(Object(u.a)({},e.viewport),t)}}))},e.resize=function(){e.setState((function(e){return{viewport:Object(u.a)(Object(u.a)({},e.viewport),{},{height:window.innerHeight})}}))},e.inputChange=function(t){if(console.log({text:t}),e.state.points){var n=e.state.points.filter((function(e){var n;return null===(n=e.Title)||void 0===n?void 0:n.toLowerCase().includes(t.toLowerCase())}));console.log("Length of ALL points:",e.state.points.length),console.log("Length of new filtered points:",n.length),e.setState({filteredPoints:n})}},e.buttonClick=function(t){e.state.markers&&j(e.state.markers)},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize),this.resize()}},{key:"UNSAFE_componentWillUpdate",value:function(){var e=Object(l.a)(s.a.mark((function e(t,n){var a,o,r,i,c,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.map&&n.filteredPoints){e.next=2;break}return e.abrupt("return");case 2:this.state.markers||n.markers||(console.log("Initial draw of map"),a=n.map,o=n.filteredPoints,L(a),r=S(a,o),this.setState({markers:r})),this.state.markers&&this.state.filteredPoints!==n.filteredPoints&&(console.log("Redrawing markers"),i=n.map,c=n.filteredPoints,j(this.state.markers),l=S(i,c),this.setState({markers:l}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"componentWillMount",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){fetch("https://spreadsheets.google.com/feeds/cells/1EWTcF12D3xEDRzAFtX_xhxZKwmWHI-88pGmQGGsKYR0/1/public/values?alt=json").then((function(e){return e.json()})).then((function(t){e(t)}))}));case 2:t=e.sent,n=t.feed.entry,a=C(n),console.log("All raw rows:"),console.log({rows:a}),o=a.map(E),console.log({feedbackItems:o}),this.setState({points:o,filteredPoints:o});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.viewport;return a.createElement("div",{id:"container"},a.createElement("div",{id:"search_overlay"},a.createElement(T,{onSearchTermUpdated:this.inputChange})),a.createElement("div",{id:"map"},a.createElement(g.b,Object.assign({width:"100%",height:"100%",className:"mapClass"},t,{mapStyle:"mapbox://styles/mapbox/streets-v11",ref:function(t){return t&&!e.state.map&&e.setState({map:t.getMap()})},mapboxApiAccessToken:"pk.eyJ1IjoiamFrZWMiLCJhIjoiY2tkaHplNGhjMDAyMDJybW4ybmRqbTBmMyJ9.AR_fnEuka8-cFb4Snp3upw",onViewportChange:function(t){return e.updateViewport(t)}}),a.createElement("div",{style:{position:"absolute",right:30,bottom:30}},a.createElement(g.a,{onViewportChange:this.updateViewport})))))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[24,1,2]]]);
//# sourceMappingURL=main.d3869c39.chunk.js.map