(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{33:function(e,t,n){e.exports=n(45)},38:function(e,t,n){},42:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var r=n(13),a=n.n(r),o=n(1),i=n.n(o),c=(n(38),n(10)),l=n.n(c),s=n(19),u=n(12),m=n(24),d=n(25),p=n(32),f=n(31),h=n(21),g=(n(42),n(8)),b=n.n(g),v=n(27);function w(e){return"mailto:".concat(encodeURI(e.mailAddress),"?subject=").concat(encodeURIComponent(e.subject),"&body=").concat(encodeURIComponent(e.body))}function k(e){var t=e.item,n="https://s2.googleusercontent.com/s2/favicons?domain_url=".concat(t.Link);switch(t.Category){case"park":n="https://i.pinimg.com/originals/20/54/42/205442f452d956de1fae3d8fb7c90d10.png";break;case"traffic":n="https://img.icons8.com/android/24/000000/traffic-light.png";break;case"cycle":n="https://img.icons8.com/cotton/64/000000/bicycle--v1.png";break;case"retail":n="https://img.icons8.com/pastel-glyph/64/000000/shop.png";break;case"housing":n="https://img.icons8.com/material-rounded/24/000000/cottage--v2.png"}return i.a.createElement("div",null,i.a.createElement("div",{style:{display:"flex"}},i.a.createElement("img",{src:n,height:20,width:20,style:{margin:"0px 4px",marginTop:4},alt:"icon"}),i.a.createElement("h2",{style:{margin:0,marginTop:4}},i.a.createElement("a",{href:t.Link,target:"_blank"},t.Title))),i.a.createElement(y,{item:t}),i.a.createElement("p",null,t.Councilname),i.a.createElement("p",null,t.Fulldescription))}function y(e){var t=e.item,n=t.Email?{mailAddress:t.Email,subject:"Submission regarding ".concat(t.Title||"<find the title on the council's website>"),body:"I'm emailing you to express my support for the proposal detailed at ".concat(t.Link,".\nReplace this line with your comments to personalise the message!")}:null,r=t.Email?{mailAddress:t.Email,subject:"Submission regarding ".concat(t.Title||"<find the title on the council's website>"),body:"I'm emailing you to express my disagreement with the proposal detailed at ".concat(t.Link,".\nReplace this line with your comments to personalise the message!")}:null;return n&&r?i.a.createElement("p",null,i.a.createElement("a",{href:w(n)},"I agree",i.a.createElement("img",{src:"https://img.icons8.com/cotton/64/000000/thumb-up--v1.png",height:12}))," /",i.a.createElement("a",{href:w(r)},"I disagree",i.a.createElement("img",{src:"https://img.icons8.com/cotton/64/000000/thumbs-down--v4.png",height:12}))):null}function E(e){return{id:parseInt(e[0]),Councilname:e[1],Longitude:parseFloat(e[2]),Latitude:parseFloat(e[3]),Title:e[4],Link:e[5],Emailcontactname:e[6],Email:e[7],Phonenumber:e[8],Surveylink:"null"===e[9]?"":e[9],Fulldescription:e[10],OpenUnderreviewclosed:e[11],Category:e[12]||""}}function j(e){for(var t=[],n=[],r=0;r<e.length;r++){var a=e[r].gs$cell,o=a.$t;1==a.col&&(n[0]&&"id"!=n[0]&&t.push(n),n=[]),n.push(o)}return n[0]&&"id"!=n[0]&&t.push(n),t}function x(e){e.addControl(new b.a.NavigationControl),e.addControl(new b.a.FullscreenControl),e.addControl(new b.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}))}function C(e){e.map((function(e){return e.remove()}))}function O(e,t){return t.filter((function(e){return e.Latitude&&e.Longitude})).map((function(t){return function(e,t){e.Title,e.Link;var n=e.Latitude,r=e.Longitude,a=e.Category,o=new b.a.Popup({offset:25}).setHTML(Object(v.renderToString)(i.a.createElement(k,{item:e}))),c={};switch(a){case"park":c.color="green";break;case"traffic":c.color="grey";break;case"cycle":c.color="red";break;case"retail":c.color="orange";break;case"housing":c.color="blue"}return new b.a.Marker(c).setLngLat([n,r]).setPopup(o).addTo(t)}(t,e)}))}var L=n(15),S=n(6),T=n(7);function I(){var e=Object(S.a)(["\n  padding: 10px;\n  max-height: 30rem;\n  overflow-x: hidden;\n  overflow-y: auto;\n"]);return I=function(){return e},e}function A(){var e=Object(S.a)(["\n  font-size: 0.8rem;\n  border: none;\n  border-radius: 3px;\n  margin-left: 0.5rem;\n  background: none;\n  :hover {\n    cursor: pointer;\n  }\n"]);return A=function(){return e},e}function F(){var e=Object(S.a)(["\n  color: #fff;\n  align-self: center;\n  color: lightgray;\n"]);return F=function(){return e},e}function P(){var e=Object(S.a)(["\n  border-radius: 8px 8px 0 0;\n  display: flex;\n  justify-content: space-between;\n  padding: 0.3rem;\n"]);return P=function(){return e},e}function z(){var e=Object(S.a)(["\n  z-index: 100;\n  background: white;\n  position: relative;\n  margin: auto;\n  border-radius: 8px;\n"]);return z=function(){return e},e}function R(){var e=Object(S.a)(["\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  background: rgba(0, 0, 0, 0.3);\n  z-index: 500;\n"]);return R=function(){return e},e}function M(){var e=Object(S.a)(["\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  z-index: 700;\n  width: inherit;\n  outline: 0;\n"]);return M=function(){return e},e}var U=T.a.div(M()),W=T.a.div(R()),_=T.a.div(z()),J=T.a.div(P()),D=T.a.div(F()),G=T.a.button(A()),H=T.a.div(I()),V=function(e){var t=e.isShown,n=e.hide,r=e.modalContent,o=e.headerText,c=i.a.createElement(i.a.Fragment,null,i.a.createElement(W,null),i.a.createElement(U,null,i.a.createElement(_,null,i.a.createElement(J,null,i.a.createElement(D,null,o),i.a.createElement(G,{onClick:n},"X")),i.a.createElement(H,null,r))));return t?a.a.createPortal(c,document.body):null};function N(){var e=Object(S.a)(["\n  width: 3rem;\n  background-color: lightgrey;\n  :hover {\n    background-color: grey;\n  }\n"]);return N=function(){return e},e}function B(){var e=Object(S.a)(["\n  width: 6rem;\n  background-color: yellow;\n  :hover {\n    background-color: red;\n  }\n"]);return B=function(){return e},e}function Z(){var e=Object(S.a)(["\n  font-size: 0.9rem;\n  margin-bottom: 10px;\n  text-align: center;\n"]);return Z=function(){return e},e}function $(){var e=Object(S.a)(["\n  display: flex;\n  justify-content: center;\n"]);return $=function(){return e},e}var K=T.a.div($()),X=T.a.div(Z()),Y=(T.a.button(B()),T.a.button(N()),function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(X,null,e.message),i.a.createElement(K,null))}),q=function(){var e=Object(o.useState)(!1),t=Object(L.a)(e,2),n=t[0],r=t[1];return{isShown:n,toggle:function(){return r(!n)}}},Q=["Cycle","Park","Zoning","Traffic"],ee=function(e){var t=e.onSearchTermUpdated,n=Object(o.useState)(""),r=Object(L.a)(n,2),a=r[0],c=r[1],l=q(),s=l.isShown,u=l.toggle;Object(o.useEffect)((function(){t(a)}),[a]);return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{id:"search_container"},i.a.createElement("h3",null,"Search:"),i.a.createElement("input",{type:"text",onChange:function(e){return c(e.target.value)},value:a})),i.a.createElement("div",{id:"search_suggestions"},Q.map((function(e){return i.a.createElement("button",{onClick:function(){return c(e)}},e)}))),i.a.createElement("p",null,"Want to know about this project?"),i.a.createElement("button",{onClick:u},"Learn More"),i.a.createElement(V,{isShown:s,hide:u,headerText:"Find Out more",modalContent:i.a.createElement(Y,{onConfirm:function(){return u()},onCancel:function(){return u()},message:"This is a hackathon project. We think its an awesome idea. If you would like your council to take this on, please email them"})}))},te=new URLSearchParams(window.location.search),ne=te.get("lat"),re=te.get("lon"),ae=ne?parseInt(ne):-33.8688,oe=re?parseInt(re):151.2093;console.log("PARAMS"),console.log({lat:ne,lon:re});var ie={viewport:{longitude:oe,latitude:ae,zoom:13}},ce=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state=ie,e.updateViewport=function(t){e.setState((function(e){return{viewport:Object(u.a)(Object(u.a)({},e.viewport),t)}}))},e.resize=function(){e.setState((function(e){return{viewport:Object(u.a)(Object(u.a)({},e.viewport),{},{height:window.innerHeight})}}))},e.inputChange=function(t){if(console.log({text:t}),e.state.points){var n=e.state.points.filter((function(e){var n;return null===(n=e.Title)||void 0===n?void 0:n.toLowerCase().includes(t.toLowerCase())}));console.log("Length of ALL points:",e.state.points.length),console.log("Length of new filtered points:",n.length),e.setState({filteredPoints:n})}},e.buttonClick=function(t){e.state.markers&&C(e.state.markers)},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize),this.resize()}},{key:"UNSAFE_componentWillUpdate",value:function(){var e=Object(s.a)(l.a.mark((function e(t,n){var r,a,o,i,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.map&&n.filteredPoints){e.next=2;break}return e.abrupt("return");case 2:this.state.markers||n.markers||(console.log("Initial draw of map"),r=n.map,a=n.filteredPoints,x(r),o=O(r,a),this.setState({markers:o})),this.state.markers&&this.state.filteredPoints!==n.filteredPoints&&(console.log("Redrawing markers"),i=n.map,c=n.filteredPoints,C(this.state.markers),s=O(i,c),this.setState({markers:s}));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"componentWillMount",value:function(){var e=Object(s.a)(l.a.mark((function e(){var t,n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){fetch("https://spreadsheets.google.com/feeds/cells/1EWTcF12D3xEDRzAFtX_xhxZKwmWHI-88pGmQGGsKYR0/1/public/values?alt=json").then((function(e){return e.json()})).then((function(t){e(t)}))}));case 2:t=e.sent,n=t.feed.entry,r=j(n),console.log("All raw rows:"),console.log({rows:r}),a=r.map(E),console.log({feedbackItems:a}),this.setState({points:a,filteredPoints:a});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.viewport;return o.createElement("div",{id:"container"},o.createElement("div",{id:"search_overlay"},o.createElement(ee,{onSearchTermUpdated:this.inputChange})),o.createElement("div",{id:"map"},o.createElement(h.b,Object.assign({width:"100%",height:"100%",className:"mapClass"},t,{mapStyle:"mapbox://styles/mapbox/streets-v11",ref:function(t){return t&&!e.state.map&&e.setState({map:t.getMap()})},mapboxApiAccessToken:"pk.eyJ1IjoiamFrZWMiLCJhIjoiY2tkaHplNGhjMDAyMDJybW4ybmRqbTBmMyJ9.AR_fnEuka8-cFb4Snp3upw",onViewportChange:function(t){return e.updateViewport(t)}}),o.createElement("div",{style:{position:"absolute",right:30,bottom:30}},o.createElement(h.a,{onViewportChange:this.updateViewport})))))}}]),n}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var le=function(){var e=q();e.isShown,e.toggle;return i.a.createElement(i.a.Fragment,null,i.a.createElement(ce,null))};Object(r.render)(i.a.createElement(le,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[33,1,2]]]);
//# sourceMappingURL=main.fe742b0a.chunk.js.map